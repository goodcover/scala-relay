# Ensure that if there are multiple sources with the same name they can extract to the same file.
> relayExtract
$ exec grep -E '# Extracted from .*/src/main/scala/example/Test\.scala' target/scala-2.13/src_managed/relay/graphql/Test.graphql
$ exec grep -E '# Extracted from .*/src/main/scala/example2/Test\.scala' target/scala-2.13/src_managed/relay/graphql/Test.graphql
$ exec grep 'query TestQuery {' target/scala-2.13/src_managed/relay/graphql/Test.graphql
$ exec grep 'query TestQuery2 {' target/scala-2.13/src_managed/relay/graphql/Test.graphql
-$ exec grep 'query TestQuery3 {' target/scala-2.13/src_managed/relay/graphql/Test.graphql

# Changing a source should replace the old extract.
$ copy-file src/main/scala/example2/Test.bak src/main/scala/example2/Test.scala
> relayExtract
$ exec grep 'query TestQuery {' target/scala-2.13/src_managed/relay/graphql/Test.graphql
-$ exec grep 'query TestQuery2 {' target/scala-2.13/src_managed/relay/graphql/Test.graphql
$ exec grep 'query TestQuery3 {' target/scala-2.13/src_managed/relay/graphql/Test.graphql
$ copy-file target/scala-2.13/src_managed/relay/graphql/Test.graphql graphql/Test.graphql

# Modifying an extract should replace the old extract from all sources.
$ touch src/main/scala/example2/Test.scala
> relayExtract
$ newer target/scala-2.13/src_managed/relay/graphql/Test.graphql graphql/Test.graphql
$ exec grep 'query TestQuery {' target/scala-2.13/src_managed/relay/graphql/Test.graphql
-$ exec grep 'query TestQuery2 {' target/scala-2.13/src_managed/relay/graphql/Test.graphql
$ exec grep 'query TestQuery3 {' target/scala-2.13/src_managed/relay/graphql/Test.graphql
